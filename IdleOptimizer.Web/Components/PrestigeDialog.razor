@using MudBlazor

<MudDialog>
    <TitleContent>
        <MudText Typo="Typo.h6">Prestige</MudText>
    </TitleContent>
    <DialogContent>
        <MudAlert Severity="Severity.Warning" Class="mb-4">
            <strong>Warning:</strong> This will reset all progress including generator counts, applied research, and current production/costs. 
            Base values will be multiplied by the specified multipliers.
        </MudAlert>
        <MudForm @ref="form" @bind-IsValid="@success" @bind-Errors="@errors">
            <MudNumericField @bind-Value="@productionMultiplier" 
                           Label="Production Multiplier" 
                           Variant="Variant.Outlined" 
                           Required="true" 
                           Min="0.01" 
                           HelperText="Multiplies BaseResources for all generators" />
            <MudNumericField @bind-Value="@costMultiplier" 
                           Label="Cost Multiplier" 
                           Variant="Variant.Outlined" 
                           Required="true" 
                           Min="0.01" 
                           HelperText="Multiplies BaseResourceCosts for generators and costs for research" 
                           Class="mt-4" />
        </MudForm>
    </DialogContent>
    <DialogActions>
        <MudButton OnClick="Cancel">Cancel</MudButton>
        <MudButton Color="Color.Warning" Variant="Variant.Filled" OnClick="Confirm" Disabled="!success">
            Confirm Prestige
        </MudButton>
    </DialogActions>
</MudDialog>

@code {
    [CascadingParameter] MudDialogInstance MudDialog { get; set; } = default!;

    private MudForm? form;
    private bool success;
    private string[] errors = { };
    private double productionMultiplier = 1.0;
    private double costMultiplier = 1.0;

    private void Cancel()
    {
        MudDialog.Cancel();
    }

    private void Confirm()
    {
        if (form != null && form.IsValid)
        {
            MudDialog.Close(DialogResult.Ok((productionMultiplier, costMultiplier)));
        }
    }
}

